!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";var o=function(){function e(e){this.socketOpen=!1,this.socket={},this.connect(e),this.listen(),this.afterConnect()}return e.prototype.listen=function(){var e=this;return new Promise(function(t,n){e.socket.onopen(function(n){e.socketOpen=!0,console.log("WebSocket opened：",n),t(n)}),e.socket.onerror(function(e){console.error("Can not open WebSocket, please check...！",e),t(e)})})},e.prototype.connect=function(e){return this.socket=new WebSocket(e),this},e.prototype.afterConnect=function(e,t){return this.socket.onmessage(function(t){console.log("Get data from webSocket server：",JSON.parse(t.data)),e(JSON.parse(t.data))}),this},e.prototype.sendMsg=function(e,t){var n=this,o=this;if(o.socketOpen){var r={},s=e.token;void 0===s?(console.log("no token"),r={"S-Request-Id":Date.now()+Math.random().toString(20).substr(2,6)}):void 0!==s&&(console.log("get token"),r={"S-Request-Id":Date.now()+Math.random().toString(20).substr(2,6),Authentication:"Bearer "+s}),n.socket.send({data:JSON.stringify({method:t,url:e.url,header:r,body:JSON.stringify(e.data)}),success:function(e){console.log("Send data success: ",e)},fail:function(e){console.log("Send data fail: ",e)}})}else console.log("websocket server not opened")},e.prototype.get=function(e,t){var n=this,o=this.handleParams(e,{},t);return setTimeout(function(){n.sendMsg(o,"GET")},300),new Promise(function(e,t){n.afterConnect(e,t)})},e.prototype.post=function(e,t,n){var o=this,r=this.handleParams(e,t,n);return setTimeout(function(){o.sendMsg(r,"POST")},300),new Promise(function(e,t){o.afterConnect(e,t)})},e.prototype.update=function(e,t){var n=this,o=this.handleParams(e,t);return setTimeout(function(){n.sendMsg(o,"UPDATE")},300),new Promise(function(e,t){n.afterConnect(e,t)})},e.prototype.delete=function(e,t){var n=this,o=this.handleParams(e,t);return setTimeout(function(){n.sendMsg(o,"DELETE")},300),new Promise(function(e,t){n.afterConnect(e,t)})},e.prototype.handleParams=function(e,t,n){var o={};return o.url=e,o.data=t,o.token=n,o},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=o}])});